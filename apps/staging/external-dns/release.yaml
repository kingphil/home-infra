apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: external-dns
  namespace: external-dns
spec:
  interval: 2h
  chart:
    spec:
      chart: external-dns
      # https://artifacthub.io/packages/helm/external-dns/external-dns
      version: "1.x"
      sourceRef:
        kind: HelmRepository
        name: external-dns
        namespace: external-dns
      interval: 2h
  values:
    domainFilters:
    - pekware.club

    provider: digitalocean

    env:
    - name: DO_TOKEN
      valueFrom:
        secretKeyRef:
          name: do-token
          key: do-token

    logLevel: info
    logFormat: text

    sources:
    - service

    registry: txt
    txtOwnerId: "flux-staging"
